Here is a structured and cleaned-up version of your **Day-7 LAB**: Setting up **Snort on Linux (Ubuntu/Debian)** â€“ including DAQ library, rule setup, permissioning, and running Snort in IDS mode.

---

## ðŸ§ª **Day-7 LAB: Snort on Linux (IDS Setup)**

---

### âœ… **1. Install Dependencies**

Install all required packages:

```bash
sudo apt update
sudo apt install -y bison ca-certificates flex gcc \
libdumbnet-dev libluajit-5.1-dev libnghttp2-dev libpcre3-dev \
libssl-dev make openssl wget zlib1g-dev libpcap-dev
```

---

### ðŸ“¦ **2. Install DAQ Library**

```bash
sudo mkdir -p /usr/src/snort_src
cd /usr/src/snort_src
# Download and extract DAQ (update version as needed)
wget https://www.snort.org/downloads/snort/daq-2.0.7.tar.gz
tar -xvzf daq-2.0.7.tar.gz
cd daq-2.0.7
./configure
make
sudo make install
```

---

### ðŸ **3. Install Snort**

```bash
cd /usr/src/snort_src
wget https://www.snort.org/downloads/snort/snort-2.9.20.tar.gz
tar -xvzf snort-2.9.20.tar.gz
cd snort-2.9.20
sudo ln -s /usr/include/tirpc/netconfig.h /usr/include/
sudo ldconfig
./configure --enable-sourcefire
make
sudo make install
```

---

### ðŸ§ª **4. Verify Snort Installation**

```bash
snort -V
```

---

### ðŸ‘¤ **5. Create Snort User and Directory Structure**

```bash
sudo groupadd snort
sudo useradd snort -r -s /usr/sbin/nologin -c SNORT_IDS -g snort

# Create required directories
sudo mkdir -p /etc/snort/rules
sudo mkdir /var/log/snort
sudo mkdir /usr/local/lib/snort_dynamicrules

# Copy config files
sudo cp /usr/src/snort_src/snort-2.9.20/etc/*.conf* /etc/snort/
sudo cp /usr/src/snort_src/snort-2.9.20/etc/*.map /etc/snort/

# Create empty rule files
sudo touch /etc/snort/rules/white_list.rules
sudo touch /etc/snort/rules/black_list.rules
sudo touch /etc/snort/rules/local.rules
```

---

### ðŸ” **6. Set Permissions**

```bash
sudo chmod -R 5775 /etc/snort
sudo chmod -R 5775 /var/log/snort/
sudo chmod -R 5775 /usr/local/lib/snort_dynamicrules/

sudo chown -R snort:snort /etc/snort
sudo chown -R snort:snort /var/log/snort/
sudo chown -R snort:snort /usr/local/lib/snort_dynamicrules/
```

---

### âš™ï¸ **7. Edit `/etc/snort/snort.conf`**

Set the following paths:

```conf
var RULE_PATH /etc/snort/rules
var SO_RULE_PATH /etc/snort/rules
var PREPROC_RULE_PATH /etc/snort/rules
var WHITE_LIST_PATH /etc/snort/rules
var BLACK_LIST_PATH /etc/snort/rules
```

Include `local.rules` and others at the end:

```conf
include $RULE_PATH/white_list.rules
include $RULE_PATH/black_list.rules
include $RULE_PATH/local.rules
```

---

### ðŸ§¾ **8. Add a Sample Rule (Optional)**

```bash
sudo nano /etc/snort/rules/local.rules
```

Add this rule:

```snort
alert icmp any any -> any any (msg:"ICMP Packet Detected"; sid:1000001; rev:1;)
```

---

### ðŸš€ **9. Run Snort in IDS Mode**

```bash
sudo snort -i ens33 -u snort -g snort -c /etc/snort/snort.conf -A console
```

---

### ðŸ“Œ Notes:

* Replace `ens33` with your active network interface (check via `ip a`).
* This setup logs alerts to console; logs also go to `/var/log/snort/`.

---

Let me know if you want to integrate **Barnyard2**, **MySQL logging**, or **real-time rule updates**.
